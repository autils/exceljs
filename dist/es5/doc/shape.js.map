{"version":3,"file":"shape.js","names":["parseRange","require","Shape","constructor","worksheet","model","props","type","rotation","horizontalFlip","verticalFlip","fill","outline","textBody","range","tl","br","ext","editAs","hyperlinks","_ref","parseAsTextBody","undefined","input","paragraphs","parseAsParagraph","Array","isArray","map","vertAlign","runs","parseAsRun","alignment","text","font","module","exports"],"sources":["../../../lib/doc/shape.js"],"sourcesContent":["const {parseRange} = require('./drawing-range');\n\nclass Shape {\n  constructor(worksheet, model) {\n    this.worksheet = worksheet;\n    this.model = model;\n  }\n\n  get model() {\n    return {\n      props: {\n        type: this.props.type,\n        rotation: this.props.rotation,\n        horizontalFlip: this.props.horizontalFlip,\n        verticalFlip: this.props.verticalFlip,\n        fill: this.props.fill,\n        outline: this.props.outline,\n        textBody: this.props.textBody,\n      },\n      range: {\n        tl: this.range.tl.model,\n        br: this.range.br && this.range.br.model,\n        ext: this.range.ext,\n        editAs: this.range.editAs,\n      },\n      hyperlinks: this.hyperlinks,\n    };\n  }\n\n  set model({props, range, hyperlinks}) {\n    this.props = {type: props.type};\n    if (props.rotation) {\n      this.props.rotation = props.rotation;\n    }\n    if (props.horizontalFlip) {\n      this.props.horizontalFlip = props.horizontalFlip;\n    }\n    if (props.verticalFlip) {\n      this.props.verticalFlip = props.verticalFlip;\n    }\n    if (props.fill) {\n      this.props.fill = props.fill;\n    }\n    if (props.outline) {\n      this.props.outline = props.outline;\n    }\n    if (props.textBody) {\n      this.props.textBody = parseAsTextBody(props.textBody);\n    }\n    this.range = parseRange(range, undefined, this.worksheet);\n    this.hyperlinks = hyperlinks;\n  }\n}\n\nfunction parseAsTextBody(input) {\n  if (typeof input === 'string') {\n    return {\n      paragraphs: [parseAsParagraph(input)],\n    };\n  }\n  if (Array.isArray(input)) {\n    return {\n      paragraphs: input.map(parseAsParagraph),\n    };\n  }\n  const model = {\n    paragraphs: input.paragraphs.map(parseAsParagraph),\n  };\n  if (input.vertAlign) {\n    model.vertAlign = input.vertAlign;\n  }\n  return model;\n}\n\nfunction parseAsParagraph(input) {\n  if (typeof input === 'string') {\n    return {\n      runs: [parseAsRun(input)],\n    };\n  }\n  if (Array.isArray(input)) {\n    return {\n      runs: input.map(parseAsRun),\n    };\n  }\n  const model = {\n    runs: input.runs.map(parseAsRun),\n  };\n  if (input.alignment) {\n    model.alignment = input.alignment;\n  }\n  return model;\n}\n\nfunction parseAsRun(input) {\n  if (typeof input === 'string') {\n    return {\n      text: input,\n    };\n  }\n  const model = {\n    text: input.text,\n  };\n  if (input.font) {\n    model.font = input.font;\n  }\n  return model;\n}\n\nmodule.exports = Shape;\n"],"mappings":"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","ignoreList":[]}