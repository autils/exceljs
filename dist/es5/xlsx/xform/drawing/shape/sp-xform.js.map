{"version":3,"file":"sp-xform.js","names":["BaseXform","require","NvSpPrXform","SpPrXform","StyleXform","TxBodyXform","SpXform","constructor","map","tag","prepare","model","options","index","render","xmlStream","shape","openNode","macro","textlink","props","textBody","closeNode","parseOpen","node","parser","name","parseText","text","parseClose","undefined","fill","outline","noFill","hyperlinks","module","exports"],"sources":["../../../../../../lib/xlsx/xform/drawing/shape/sp-xform.js"],"sourcesContent":["const BaseXform = require('../../base-xform');\n\nconst NvSpPrXform = require('./nv-sp-pr-xform');\nconst SpPrXform = require('./sp-pr-xform');\nconst StyleXform = require('./style-xform');\nconst TxBodyXform = require('./tx-body-xform');\n\n// DocumentFormat.OpenXml.Drawing.Spreadsheet.Shape\nclass SpXform extends BaseXform {\n  constructor() {\n    super();\n\n    this.map = {\n      'xdr:nvSpPr': new NvSpPrXform(),\n      'xdr:spPr': new SpPrXform(),\n      'xdr:style': new StyleXform(),\n      'xdr:txBody': new TxBodyXform(),\n    };\n  }\n\n  get tag() {\n    return 'xdr:sp';\n  }\n\n  prepare(model, options) {\n    model.index = options.index + 1;\n  }\n\n  render(xmlStream, shape) {\n    xmlStream.openNode(this.tag, {macro: '', textlink: ''});\n\n    this.map['xdr:nvSpPr'].render(xmlStream, shape);\n    this.map['xdr:spPr'].render(xmlStream, shape.props);\n    this.map['xdr:style'].render(xmlStream, shape.props);\n    if (shape.props.textBody) {\n      this.map['xdr:txBody'].render(xmlStream, shape.props.textBody);\n    }\n    xmlStream.closeNode();\n  }\n\n  parseOpen(node) {\n    if (this.parser) {\n      this.parser.parseOpen(node);\n      this.model = {props: {}};\n      return true;\n    }\n    switch (node.name) {\n      case this.tag:\n        break;\n      default:\n        this.parser = this.map[node.name];\n        if (this.parser) {\n          this.parser.parseOpen(node);\n        }\n        break;\n    }\n    return true;\n  }\n\n  parseText(text) {\n    if (this.parser) {\n      this.parser.parseText(text);\n    }\n  }\n\n  parseClose(name) {\n    if (this.parser) {\n      if (!this.parser.parseClose(name)) {\n        this.parser = undefined;\n      }\n      return true;\n    }\n    switch (name) {\n      case this.tag:\n        if (this.map['xdr:style'].model) {\n          this.model.props = {\n            ...(this.map['xdr:style'].model.fill ? {fill: this.map['xdr:style'].model.fill} : {}),\n            ...(this.map['xdr:style'].model.outline ? {outline: this.map['xdr:style'].model.outline} : {}),\n          };\n        }\n        if (this.map['xdr:spPr'].model) {\n          this.model.props = {\n            ...this.model.props,\n            ...this.map['xdr:spPr'].model,\n          };\n        }\n        if (this.map['xdr:txBody'].model) {\n          this.model.props.textBody = this.map['xdr:txBody'].model;\n        }\n        if (this.map['xdr:spPr'].noFill) {\n          delete this.model.props.fill;\n        }\n        if (this.map['xdr:nvSpPr'].model) {\n          this.model.hyperlinks = this.map['xdr:nvSpPr'].model.hyperlinks;\n        }\n        return false;\n      default:\n        return true;\n    }\n  }\n}\n\nmodule.exports = SpXform;\n"],"mappings":"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","ignoreList":[]}