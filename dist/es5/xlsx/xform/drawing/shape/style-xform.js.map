{"version":3,"file":"style-xform.js","names":["BaseXform","require","StaticXform","StyleMatrixReferenceTypeXform","StyleXform","constructor","map","effectRefJSON","fontRefJSON","tag","render","xmlStream","shape","openNode","effectRef","fontRef","closeNode","parseOpen","node","parser","name","model","parseText","parseClose","undefined","outline","fill","type","color","$","idx","c","val","module","exports"],"sources":["../../../../../../lib/xlsx/xform/drawing/shape/style-xform.js"],"sourcesContent":["const BaseXform = require('../../base-xform');\nconst StaticXform = require('../../static-xform');\nconst StyleMatrixReferenceTypeXform = require('./style-matrix-reference-type-xform');\n\n// DocumentFormat.OpenXml.Drawing.Spreadsheet.ShapeStyle\nclass StyleXform extends BaseXform {\n  constructor() {\n    super();\n\n    this.map = {\n      'a:lnRef': new StyleMatrixReferenceTypeXform('a:lnRef'),\n      'a:fillRef': new StyleMatrixReferenceTypeXform('a:fillRef'),\n      'a:effectRef': new StaticXform(effectRefJSON),\n      'a:fontRef': new StaticXform(fontRefJSON),\n    };\n  }\n\n  get tag() {\n    return 'xdr:style';\n  }\n\n  render(xmlStream, shape) {\n    xmlStream.openNode(this.tag);\n    // Must care about the order\n    this.map['a:lnRef'].render(xmlStream);\n    this.map['a:fillRef'].render(xmlStream);\n    this.map['a:effectRef'].render(xmlStream, shape.effectRef);\n    this.map['a:fontRef'].render(xmlStream, shape.fontRef);\n    xmlStream.closeNode();\n  }\n\n  parseOpen(node) {\n    if (this.parser) {\n      this.parser.parseOpen(node);\n      return true;\n    }\n\n    switch (node.name) {\n      case this.tag:\n        this.model = {};\n        break;\n      default:\n        this.parser = this.map[node.name];\n        if (this.parser) {\n          this.parser.parseOpen(node);\n        }\n        break;\n    }\n    return true;\n  }\n\n  parseText() {}\n\n  parseClose(name) {\n    if (this.parser) {\n      if (!this.parser.parseClose(name)) {\n        this.parser = undefined;\n      }\n      return true;\n    }\n    switch (name) {\n      case this.tag:\n        if (this.map['a:lnRef'].model) {\n          this.model.outline = this.map['a:lnRef'].model;\n        }\n        if (this.map['a:fillRef'].model) {\n          this.model.fill = {\n            type: 'solid',\n            color: this.map['a:fillRef'].model,\n          };\n        }\n        return false;\n      default:\n        return true;\n    }\n  }\n}\n\nconst effectRefJSON = {\n  tag: 'a:effectRef',\n  $: {idx: '0'},\n  c: [\n    {\n      tag: 'a:schemeClr',\n      $: {val: 'accent1'},\n    },\n  ],\n};\n\nconst fontRefJSON = {\n  tag: 'a:fontRef',\n  $: {idx: 'minor'},\n  c: [\n    {\n      tag: 'a:schemeClr',\n      $: {val: 'lt1'},\n    },\n  ],\n};\n\nmodule.exports = StyleXform;\n"],"mappings":";;AAAA,MAAMA,SAAS,GAAGC,OAAO,CAAC,kBAAkB,CAAC;AAC7C,MAAMC,WAAW,GAAGD,OAAO,CAAC,oBAAoB,CAAC;AACjD,MAAME,6BAA6B,GAAGF,OAAO,CAAC,qCAAqC,CAAC;;AAEpF;AACA,MAAMG,UAAU,SAASJ,SAAS,CAAC;EACjCK,WAAWA,CAAA,EAAG;IACZ,KAAK,CAAC,CAAC;IAEP,IAAI,CAACC,GAAG,GAAG;MACT,SAAS,EAAE,IAAIH,6BAA6B,CAAC,SAAS,CAAC;MACvD,WAAW,EAAE,IAAIA,6BAA6B,CAAC,WAAW,CAAC;MAC3D,aAAa,EAAE,IAAID,WAAW,CAACK,aAAa,CAAC;MAC7C,WAAW,EAAE,IAAIL,WAAW,CAACM,WAAW;IAC1C,CAAC;EACH;EAEA,IAAIC,GAAGA,CAAA,EAAG;IACR,OAAO,WAAW;EACpB;EAEAC,MAAMA,CAACC,SAAS,EAAEC,KAAK,EAAE;IACvBD,SAAS,CAACE,QAAQ,CAAC,IAAI,CAACJ,GAAG,CAAC;IAC5B;IACA,IAAI,CAACH,GAAG,CAAC,SAAS,CAAC,CAACI,MAAM,CAACC,SAAS,CAAC;IACrC,IAAI,CAACL,GAAG,CAAC,WAAW,CAAC,CAACI,MAAM,CAACC,SAAS,CAAC;IACvC,IAAI,CAACL,GAAG,CAAC,aAAa,CAAC,CAACI,MAAM,CAACC,SAAS,EAAEC,KAAK,CAACE,SAAS,CAAC;IAC1D,IAAI,CAACR,GAAG,CAAC,WAAW,CAAC,CAACI,MAAM,CAACC,SAAS,EAAEC,KAAK,CAACG,OAAO,CAAC;IACtDJ,SAAS,CAACK,SAAS,CAAC,CAAC;EACvB;EAEAC,SAASA,CAACC,IAAI,EAAE;IACd,IAAI,IAAI,CAACC,MAAM,EAAE;MACf,IAAI,CAACA,MAAM,CAACF,SAAS,CAACC,IAAI,CAAC;MAC3B,OAAO,IAAI;IACb;IAEA,QAAQA,IAAI,CAACE,IAAI;MACf,KAAK,IAAI,CAACX,GAAG;QACX,IAAI,CAACY,KAAK,GAAG,CAAC,CAAC;QACf;MACF;QACE,IAAI,CAACF,MAAM,GAAG,IAAI,CAACb,GAAG,CAACY,IAAI,CAACE,IAAI,CAAC;QACjC,IAAI,IAAI,CAACD,MAAM,EAAE;UACf,IAAI,CAACA,MAAM,CAACF,SAAS,CAACC,IAAI,CAAC;QAC7B;QACA;IACJ;IACA,OAAO,IAAI;EACb;EAEAI,SAASA,CAAA,EAAG,CAAC;EAEbC,UAAUA,CAACH,IAAI,EAAE;IACf,IAAI,IAAI,CAACD,MAAM,EAAE;MACf,IAAI,CAAC,IAAI,CAACA,MAAM,CAACI,UAAU,CAACH,IAAI,CAAC,EAAE;QACjC,IAAI,CAACD,MAAM,GAAGK,SAAS;MACzB;MACA,OAAO,IAAI;IACb;IACA,QAAQJ,IAAI;MACV,KAAK,IAAI,CAACX,GAAG;QACX,IAAI,IAAI,CAACH,GAAG,CAAC,SAAS,CAAC,CAACe,KAAK,EAAE;UAC7B,IAAI,CAACA,KAAK,CAACI,OAAO,GAAG,IAAI,CAACnB,GAAG,CAAC,SAAS,CAAC,CAACe,KAAK;QAChD;QACA,IAAI,IAAI,CAACf,GAAG,CAAC,WAAW,CAAC,CAACe,KAAK,EAAE;UAC/B,IAAI,CAACA,KAAK,CAACK,IAAI,GAAG;YAChBC,IAAI,EAAE,OAAO;YACbC,KAAK,EAAE,IAAI,CAACtB,GAAG,CAAC,WAAW,CAAC,CAACe;UAC/B,CAAC;QACH;QACA,OAAO,KAAK;MACd;QACE,OAAO,IAAI;IACf;EACF;AACF;AAEA,MAAMd,aAAa,GAAG;EACpBE,GAAG,EAAE,aAAa;EAClBoB,CAAC,EAAE;IAACC,GAAG,EAAE;EAAG,CAAC;EACbC,CAAC,EAAE,CACD;IACEtB,GAAG,EAAE,aAAa;IAClBoB,CAAC,EAAE;MAACG,GAAG,EAAE;IAAS;EACpB,CAAC;AAEL,CAAC;AAED,MAAMxB,WAAW,GAAG;EAClBC,GAAG,EAAE,WAAW;EAChBoB,CAAC,EAAE;IAACC,GAAG,EAAE;EAAO,CAAC;EACjBC,CAAC,EAAE,CACD;IACEtB,GAAG,EAAE,aAAa;IAClBoB,CAAC,EAAE;MAACG,GAAG,EAAE;IAAK;EAChB,CAAC;AAEL,CAAC;AAEDC,MAAM,CAACC,OAAO,GAAG9B,UAAU","ignoreList":[]}