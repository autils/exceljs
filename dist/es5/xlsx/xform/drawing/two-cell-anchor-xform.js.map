{"version":3,"file":"two-cell-anchor-xform.js","names":["BaseCellAnchorXform","require","StaticXform","CellPositionXform","PicXform","SpXform","TwoCellAnchorXform","constructor","map","tag","prepare","model","options","picture","shape","render","xmlStream","openNode","editAs","range","tl","br","closeNode","parseClose","name","parser","undefined","reconcile","medium","reconcilePicture","module","exports"],"sources":["../../../../../lib/xlsx/xform/drawing/two-cell-anchor-xform.js"],"sourcesContent":["const BaseCellAnchorXform = require('./base-cell-anchor-xform');\nconst StaticXform = require('../static-xform');\n\nconst CellPositionXform = require('./cell-position-xform');\nconst PicXform = require('./picture/pic-xform');\nconst SpXform = require('./shape/sp-xform');\n\nclass TwoCellAnchorXform extends BaseCellAnchorXform {\n  constructor() {\n    super();\n\n    this.map = {\n      'xdr:from': new CellPositionXform({tag: 'xdr:from'}),\n      'xdr:to': new CellPositionXform({tag: 'xdr:to'}),\n      'xdr:pic': new PicXform(),\n      'xdr:sp': new SpXform(),\n      'xdr:clientData': new StaticXform({tag: 'xdr:clientData'}),\n    };\n  }\n\n  get tag() {\n    return 'xdr:twoCellAnchor';\n  }\n\n  prepare(model, options) {\n    if (model.picture) {\n      this.map['xdr:pic'].prepare(model.picture, options);\n    }\n    if (model.shape) {\n      this.map['xdr:sp'].prepare(model.shape, options);\n    }\n  }\n\n  render(xmlStream, model) {\n    xmlStream.openNode(this.tag, {editAs: model.range.editAs || 'oneCell'});\n\n    this.map['xdr:from'].render(xmlStream, model.range.tl);\n    this.map['xdr:to'].render(xmlStream, model.range.br);\n    if (model.picture) {\n      this.map['xdr:pic'].render(xmlStream, model.picture);\n    }\n    if (model.shape) {\n      this.map['xdr:sp'].render(xmlStream, model.shape);\n    }\n    this.map['xdr:clientData'].render(xmlStream, {});\n\n    xmlStream.closeNode();\n  }\n\n  parseClose(name) {\n    if (this.parser) {\n      if (!this.parser.parseClose(name)) {\n        this.parser = undefined;\n      }\n      return true;\n    }\n    switch (name) {\n      case this.tag:\n        this.model.range.tl = this.map['xdr:from'].model;\n        this.model.range.br = this.map['xdr:to'].model;\n        this.model.picture = this.map['xdr:pic'].model;\n        this.model.shape = this.map['xdr:sp'].model;\n        return false;\n      default:\n        // could be some unrecognised tags\n        return true;\n    }\n  }\n\n  reconcile(model, options) {\n    model.medium = this.reconcilePicture(model.picture, options);\n  }\n}\n\nmodule.exports = TwoCellAnchorXform;\n"],"mappings":"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","ignoreList":[]}